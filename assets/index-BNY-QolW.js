import{r as x,c as nt,g as at,e as ot,u as H,f as it,R as Ce,h as Pe,i as lt,j as L,N as Q,H as ct}from"./vendor-BT3SA_Mp.js";import{r as dt,T as z,F as _,C,I as M,R as J,a as ut,B as E,s as I,L as he,M as pt,b as mt,c as ht,D as xt,A as Re,d as gt,e as ft,f as yt,g as ge,h as G,E as fe,i as ye,j as je,P as ee,k as te,l as Le,m as Z,n as D,S as Y,o as ke,p as Me,q as jt,t as vt,U as Ne,u as Oe,v as X,w as $,x as K,y as Tt,z as De,G as $e,H as ze,J as It}from"./antd-uuZQaa5X.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=o(a);fetch(a.href,i)}})();var Ge={exports:{}},re={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bt=x,_t=Symbol.for("react.element"),Et=Symbol.for("react.fragment"),At=Object.prototype.hasOwnProperty,St=bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wt={key:!0,ref:!0,__self:!0,__source:!0};function Ye(r,s,o){var n,a={},i=null,c=null;o!==void 0&&(i=""+o),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(c=s.ref);for(n in s)At.call(s,n)&&!wt.hasOwnProperty(n)&&(a[n]=s[n]);if(r&&r.defaultProps)for(n in s=r.defaultProps,s)a[n]===void 0&&(a[n]=s[n]);return{$$typeof:_t,type:r,key:i,ref:c,props:a,_owner:St.current}}re.Fragment=Et;re.jsx=Ye;re.jsxs=Ye;Ge.exports=re;var e=Ge.exports,xe={},ve=nt;xe.createRoot=ve.createRoot,xe.hydrateRoot=ve.hydrateRoot;var se={},He={exports:{}};(function(r){function s(o){return o&&o.__esModule?o:{default:o}}r.exports=s,r.exports.__esModule=!0,r.exports.default=r.exports})(He);var ne=He.exports,ae={};Object.defineProperty(ae,"__esModule",{value:!0});ae.default=void 0;var Ct={items_per_page:"条/页",jump_to:"跳至",jump_to_confirm:"确定",page:"页",prev_page:"上一页",next_page:"下一页",prev_5:"向前 5 页",next_5:"向后 5 页",prev_3:"向前 3 页",next_3:"向后 3 页",page_size:"页码"};ae.default=Ct;var oe={},q={},ie={},Ue={exports:{}},Fe={exports:{}},Be={exports:{}},Xe={exports:{}};(function(r){function s(o){"@babel/helpers - typeof";return r.exports=s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r.exports.__esModule=!0,r.exports.default=r.exports,s(o)}r.exports=s,r.exports.__esModule=!0,r.exports.default=r.exports})(Xe);var Ve=Xe.exports,qe={exports:{}};(function(r){var s=Ve.default;function o(n,a){if(s(n)!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var c=i.call(n,a||"default");if(s(c)!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(n)}r.exports=o,r.exports.__esModule=!0,r.exports.default=r.exports})(qe);var Pt=qe.exports;(function(r){var s=Ve.default,o=Pt;function n(a){var i=o(a,"string");return s(i)=="symbol"?i:i+""}r.exports=n,r.exports.__esModule=!0,r.exports.default=r.exports})(Be);var Rt=Be.exports;(function(r){var s=Rt;function o(n,a,i){return(a=s(a))in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i,n}r.exports=o,r.exports.__esModule=!0,r.exports.default=r.exports})(Fe);var Lt=Fe.exports;(function(r){var s=Lt;function o(a,i){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);i&&(d=d.filter(function(T){return Object.getOwnPropertyDescriptor(a,T).enumerable})),c.push.apply(c,d)}return c}function n(a){for(var i=1;i<arguments.length;i++){var c=arguments[i]!=null?arguments[i]:{};i%2?o(Object(c),!0).forEach(function(d){s(a,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):o(Object(c)).forEach(function(d){Object.defineProperty(a,d,Object.getOwnPropertyDescriptor(c,d))})}return a}r.exports=n,r.exports.__esModule=!0,r.exports.default=r.exports})(Ue);var kt=Ue.exports,le={};Object.defineProperty(le,"__esModule",{value:!0});le.commonLocale=void 0;le.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0};var Mt=ne.default;Object.defineProperty(ie,"__esModule",{value:!0});ie.default=void 0;var Te=Mt(kt),Nt=le,Ot=(0,Te.default)((0,Te.default)({},Nt.commonLocale),{},{locale:"zh_CN",today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",week:"周",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪",yearFormat:"YYYY年",cellDateFormat:"D",monthBeforeYear:!1});ie.default=Ot;var W={};Object.defineProperty(W,"__esModule",{value:!0});W.default=void 0;const Dt={placeholder:"请选择时间",rangePlaceholder:["开始时间","结束时间"]};W.default=Dt;var We=ne.default;Object.defineProperty(q,"__esModule",{value:!0});q.default=void 0;var $t=We(ie),zt=We(W);const Ke={lang:Object.assign({placeholder:"请选择日期",yearPlaceholder:"请选择年份",quarterPlaceholder:"请选择季度",monthPlaceholder:"请选择月份",weekPlaceholder:"请选择周",rangePlaceholder:["开始日期","结束日期"],rangeYearPlaceholder:["开始年份","结束年份"],rangeMonthPlaceholder:["开始月份","结束月份"],rangeQuarterPlaceholder:["开始季度","结束季度"],rangeWeekPlaceholder:["开始周","结束周"]},$t.default),timePickerLocale:Object.assign({},zt.default)};Ke.lang.ok="确定";q.default=Ke;var Gt=ne.default;Object.defineProperty(oe,"__esModule",{value:!0});oe.default=void 0;var Yt=Gt(q);oe.default=Yt.default;var ce=ne.default;Object.defineProperty(se,"__esModule",{value:!0});se.default=void 0;var Ht=ce(ae),Ut=ce(oe),Ft=ce(q),Bt=ce(W);const R="${label}不是一个有效的${type}",Xt={locale:"zh-cn",Pagination:Ht.default,DatePicker:Ft.default,TimePicker:Bt.default,Calendar:Ut.default,global:{placeholder:"请选择",close:"关闭"},Table:{filterTitle:"筛选",filterConfirm:"确定",filterReset:"重置",filterEmptyText:"无筛选项",filterCheckAll:"全选",filterSearchPlaceholder:"在筛选项中搜索",emptyText:"暂无数据",selectAll:"全选当页",selectInvert:"反选当页",selectNone:"清空所有",selectionAll:"全选所有",sortTitle:"排序",expand:"展开行",collapse:"关闭行",triggerDesc:"点击降序",triggerAsc:"点击升序",cancelSort:"取消排序"},Modal:{okText:"确定",cancelText:"取消",justOkText:"知道了"},Tour:{Next:"下一步",Previous:"上一步",Finish:"结束导览"},Popconfirm:{cancelText:"取消",okText:"确定"},Transfer:{titles:["",""],searchPlaceholder:"请输入搜索内容",itemUnit:"项",itemsUnit:"项",remove:"删除",selectCurrent:"全选当页",removeCurrent:"删除当页",selectAll:"全选所有",deselectAll:"取消全选",removeAll:"删除全部",selectInvert:"反选当页"},Upload:{uploading:"文件上传中",removeFile:"删除文件",uploadError:"上传错误",previewFile:"预览文件",downloadFile:"下载文件"},Empty:{description:"暂无数据"},Icon:{icon:"图标"},Text:{edit:"编辑",copy:"复制",copied:"复制成功",expand:"展开",collapse:"收起"},Form:{optional:"（可选）",defaultValidateMessages:{default:"字段验证错误${label}",required:"请输入${label}",enum:"${label}必须是其中一个[${enum}]",whitespace:"${label}不能为空字符",date:{format:"${label}日期格式无效",parse:"${label}不能转换为日期",invalid:"${label}是一个无效日期"},types:{string:R,method:R,array:R,object:R,number:R,date:R,boolean:R,integer:R,float:R,regexp:R,email:R,url:R,hex:R},string:{len:"${label}须为${len}个字符",min:"${label}最少${min}个字符",max:"${label}最多${max}个字符",range:"${label}须在${min}-${max}字符之间"},number:{len:"${label}必须等于${len}",min:"${label}最小值为${min}",max:"${label}最大值为${max}",range:"${label}须在${min}-${max}之间"},array:{len:"须为${len}个${label}",min:"最少${min}个${label}",max:"最多${max}个${label}",range:"${label}数量须在${min}-${max}之间"},pattern:{mismatch:"${label}与模式不匹配${pattern}"}}},Image:{preview:"预览"},QRCode:{expired:"二维码过期",refresh:"点击刷新",scanned:"已扫描"},ColorPicker:{presetEmpty:"暂无",transparent:"无色",singleColor:"单色",gradientColor:"渐变色"}};se.default=Xt;var Vt=se;const qt=at(Vt);var Wt={exports:{}};(function(r,s){(function(o,n){r.exports=n(dt())})(ot,function(o){function n(c){return c&&typeof c=="object"&&"default"in c?c:{default:c}}var a=n(o),i={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(c,d){return d==="W"?c+"周":c+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(c,d){var T=100*c+d;return T<600?"凌晨":T<900?"早上":T<1100?"上午":T<1300?"中午":T<1800?"下午":"晚上"}};return a.default.locale(i,null,!0),i})})(Wt);const Qe=x.createContext(void 0),de=()=>{const r=x.useContext(Qe);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r},Kt=({children:r})=>{const[s,o]=x.useState(null),[n,a]=x.useState(!1);x.useEffect(()=>{const T=localStorage.getItem("auth_user"),m=localStorage.getItem("auth_token");if(T&&m)try{const l=JSON.parse(T);o(l),a(!0)}catch(l){console.error("Failed to parse saved user data:",l),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_token")}},[]);const d={user:s,isAuthenticated:n,login:async(T,m)=>{if(await new Promise(l=>setTimeout(l,1e3)),T==="Admin"&&m==="5173rongcloud"){const l={id:"1",username:"Admin"},t="mock_jwt_token_"+Date.now();return localStorage.setItem("auth_user",JSON.stringify(l)),localStorage.setItem("auth_token",t),o(l),a(!0),!0}return!1},logout:()=>{localStorage.removeItem("auth_user"),localStorage.removeItem("auth_token"),o(null),a(!1)}};return e.jsx(Qe.Provider,{value:d,children:r})},{Title:Qt,Text:Jt}=z,Zt=()=>{const[r]=_.useForm(),[s,o]=x.useState(!1),n=H(),{login:a}=de(),i=async c=>{o(!0);try{await a(c.username,c.password)?(I.success("登录成功！"),n("/simple")):I.error("用户名或密码错误")}catch(d){console.error("Login error:",d),I.error("登录失败，请稍后重试")}finally{o(!1)}};return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:e.jsxs(C,{style:{width:"100%",maxWidth:400,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",borderRadius:"12px"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:32},children:[e.jsx(Qt,{level:2,style:{color:"#1890ff",marginBottom:8},children:"AI角色管理后台"}),e.jsx(Jt,{type:"secondary",children:"H5 Demo 管理系统"})]}),e.jsxs(_,{form:r,name:"login",layout:"vertical",onFinish:i,autoComplete:"off",size:"large",children:[e.jsx(_.Item,{name:"username",label:"用户名",rules:[{required:!0,message:"请输入用户名"},{min:2,message:"用户名至少2个字符"}],children:e.jsx(M,{prefix:e.jsx(J,{}),placeholder:"请输入用户名"})}),e.jsx(_.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码"},{min:6,message:"密码至少6个字符"}],children:e.jsx(M.Password,{prefix:e.jsx(ut,{}),placeholder:"请输入密码"})}),e.jsx(_.Item,{children:e.jsx(E,{type:"primary",htmlType:"submit",loading:s,block:!0,style:{height:48,fontSize:16,borderRadius:8},children:s?"登录中...":"登录"})})]}),e.jsxs("div",{style:{marginTop:24,padding:16,background:"#f8f9fa",borderRadius:8,fontSize:12,color:"#666"},children:[e.jsx("div",{style:{marginBottom:8,fontWeight:"bold"},children:"Demo 测试账号："}),e.jsx("div",{children:"用户名：Admin"}),e.jsx("div",{children:"密码：5173rongcloud"})]})]})})},er=[{key:"zh",label:"中文",flag:"🇨🇳"},{key:"en",label:"English",flag:"🇺🇸"},{key:"ar",label:"العربية",flag:"🇸🇦"}],Je=[{value:"male",label:"男性"},{value:"female",label:"女性"},{value:"other",label:"其他"}],Ze=[{value:"public",label:"公开"},{value:"private",label:"私有"}],et=[{value:"welcome",label:"欢迎消息"},{value:"support",label:"技术支持"},{value:"product",label:"产品介绍"},{value:"faq",label:"常见问题"},{value:"other",label:"其他"}],tt={DEFAULT_PAGE_SIZE:10,PAGE_SIZE_OPTIONS:["10","20","50","100"],SHOW_SIZE_CHANGER:!0,SHOW_QUICK_JUMPER:!0},V={MAX_FILE_SIZE:5*1024*1024,ACCEPTED_IMAGE_TYPES:["image/jpeg","image/jpg","image/png","image/gif","image/webp"],MAX_DISPLAY_IMAGES:6},g={REQUIRED:{required:!0,message:"此项为必填项"},PHONE:{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码格式"},AGE:{type:"number",min:1,max:150,message:"年龄必须在1-150之间"},MAX_LENGTH:{NICKNAME:50,REGION:50,PROFESSION:50,INTRODUCTION:500,TAG:20,GREETING:200,SYSTEM_PROMPT:2e3,TEMPLATE_NAME:100,TEMPLATE_DESCRIPTION:200,TEMPLATE_CONTENT:5e3}},U={CHARACTER:{AGE:25,GENDER:"female",PERMISSION:"public",AVATAR:"https://images.unsplash.com/photo-1494790108755-2616b612b742?w=150&h=150&fit=crop&crop=face"},TEMPLATE:{CATEGORY:"other",IS_ACTIVE:!0}},tr=[{key:"characters",label:"AI角色管理",icon:"UserOutlined",path:"/characters"},{key:"templates",label:"模板管理",icon:"FileTextOutlined",path:"/templates"},{key:"config",label:"通用配置",icon:"SettingOutlined",path:"/config"}],{Header:rr,Sider:sr,Content:nr}=he,ar=({children:r})=>{const[s,o]=x.useState(!1),n=H(),a=it(),{user:i,logout:c}=de(),d=()=>{const p=a.hash||window.location.hash,f=a.pathname,S=p?p.replace("#",""):f;return S.includes("/characters")?"characters":S.includes("/templates")?"templates":S.includes("/config")?"config":"characters"},T=({key:p})=>{const f=tr.find(S=>S.key===p);f&&n(f.path)},m=()=>{c(),n("/login")},l=[{key:"logout",icon:e.jsx(yt,{}),label:"退出登录",onClick:m}],t=[{key:"characters",icon:e.jsx(J,{}),label:"AI角色管理"},{key:"templates",icon:e.jsx(gt,{}),label:"模板管理"},{key:"config",icon:e.jsx(ft,{}),label:"通用配置"}];return e.jsxs(he,{style:{minHeight:"100vh"},children:[e.jsxs(sr,{trigger:null,collapsible:!0,collapsed:s,theme:"dark",children:[e.jsx("div",{style:{height:64,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"18px",fontWeight:"bold",borderBottom:"1px solid #404040"},children:s?"AI":"AI角色管理后台"}),e.jsx(pt,{theme:"dark",mode:"inline",selectedKeys:[d()],items:t,onClick:T,style:{borderRight:0}})]}),e.jsxs(he,{children:[e.jsxs(rr,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #f0f0f0"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx(E,{type:"text",icon:s?e.jsx(mt,{}):e.jsx(ht,{}),onClick:()=>o(!s),style:{fontSize:"16px",width:64,height:64}})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsxs("span",{children:["欢迎，",i==null?void 0:i.username]}),e.jsx(xt,{menu:{items:l},placement:"bottomRight",arrow:!0,children:e.jsx(Re,{style:{backgroundColor:"#1890ff",cursor:"pointer"},icon:e.jsx(J,{})})})]})]}),e.jsx(nr,{style:{margin:"24px",padding:"24px",background:"#fff",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:r})]})]})},or="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let k=(r=21)=>{let s="",o=crypto.getRandomValues(new Uint8Array(r|=0));for(;r--;)s+=or[o[r]&63];return s};const A=(r,s,o)=>({zh:r,en:s,ar:o}),ir=()=>[{id:k(),botId:`bot_${k()}`,avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b742?w=150&h=150&fit=crop&crop=face",gender:"female",age:25,permission:"public",nickname:A("小雅助手","Xiaoya Assistant","مساعد شياويا"),region:A("北京","Beijing","بكين"),profession:A("AI助手","AI Assistant","مساعد ذكي"),introduction:A("我是小雅，一个友善的AI助手，可以帮助您解答问题和提供建议。","I am Xiaoya, a friendly AI assistant who can help answer questions and provide advice.","أنا شياويا، مساعد ذكي ودود يمكنني مساعدتك في الإجابة على الأسئلة وتقديم النصائح."),tags:{zh:["友善","专业","高效"],en:["Friendly","Professional","Efficient"],ar:["ودود","محترف","فعال"]},greeting:A("你好！我是小雅，很高兴为您服务！有什么可以帮助您的吗？","Hello! I am Xiaoya, nice to serve you! How can I help you?","مرحبا! أنا شياويا، من دواعي سروري خدمتك! كيف يمكنني مساعدتك؟"),displayImages:["https://images.unsplash.com/photo-1494790108755-2616b612b742?w=300&h=400&fit=crop","https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=300&h=400&fit=crop"],systemPrompt:"You are Xiaoya, a helpful and friendly AI assistant. Always be polite, professional, and try your best to help users with their questions.",whitelist:["13800138000","13900139000"],createdAt:new Date("2024-01-15").toISOString(),updatedAt:new Date("2024-01-20").toISOString()},{id:k(),botId:`bot_${k()}`,avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",gender:"male",age:30,permission:"private",nickname:A("技术专家Tom","Tech Expert Tom","خبير التكنولوجيا توم"),region:A("上海","Shanghai","شنغهاي"),profession:A("技术顾问","Technical Consultant","مستشار تقني"),introduction:A("我是Tom，专注于技术领域的AI助手，擅长编程、架构设计和技术咨询。","I am Tom, an AI assistant focused on technology, specializing in programming, architecture design, and technical consulting.","أنا توم، مساعد ذكي يركز على التكنولوجيا، متخصص في البرمجة وتصميم البنية التحتية والاستشارات التقنية."),tags:{zh:["技术","编程","架构","专业"],en:["Technology","Programming","Architecture","Professional"],ar:["تكنولوجيا","برمجة","هندسة معمارية","محترف"]},greeting:A("您好！我是Tom，您的技术顾问。有什么技术问题需要探讨吗？","Hello! I am Tom, your technical consultant. Any technical questions to discuss?","مرحبا! أنا توم، مستشارك التقني. هل لديك أي أسئلة تقنية للمناقشة؟"),displayImages:["https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=300&h=400&fit=crop","https://images.unsplash.com/photo-1560250097-0b93528c311a?w=300&h=400&fit=crop"],systemPrompt:"You are Tom, a technical expert AI assistant. You specialize in programming, software architecture, and providing technical solutions. Be precise, helpful, and professional.",whitelist:["13700137000","13600136000","13500135000"],createdAt:new Date("2024-01-10").toISOString(),updatedAt:new Date("2024-01-18").toISOString()},{id:k(),botId:`bot_${k()}`,avatar:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face",gender:"female",age:28,permission:"public",nickname:A("创意设计师Lily","Creative Designer Lily","المصممة الإبداعية ليلي"),region:A("深圳","Shenzhen","شنتشن"),profession:A("UI/UX设计师","UI/UX Designer","مصمم واجهة المستخدم"),introduction:A("我是Lily，专业的UI/UX设计师，热爱创意设计，可以为您提供设计建议和创意灵感。","I am Lily, a professional UI/UX designer who loves creative design and can provide design advice and creative inspiration.","أنا ليلي، مصممة واجهة مستخدم محترفة أحب التصميم الإبداعي ويمكنني تقديم نصائح التصميم والإلهام الإبداعي."),tags:{zh:["创意","设计","美学","用户体验"],en:["Creative","Design","Aesthetic","User Experience"],ar:["إبداعي","تصميم","جمالي","تجربة المستخدم"]},greeting:A("嗨！我是Lily，让我们一起创造美好的设计吧！有什么设计需求吗？","Hi! I am Lily, let's create beautiful designs together! Any design needs?","مرحبا! أنا ليلي، دعونا ننشئ تصاميم جميلة معا! هل لديك أي احتياجات تصميمية؟"),displayImages:["https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=300&h=400&fit=crop","https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=300&h=400&fit=crop"],systemPrompt:"You are Lily, a creative UI/UX designer AI assistant. You are passionate about design, aesthetics, and user experience. Provide creative and practical design advice.",whitelist:[],createdAt:new Date("2024-01-12").toISOString(),updatedAt:new Date("2024-01-22").toISOString()}],lr=()=>[{id:k(),name:A("欢迎消息模板","Welcome Message Template","قالب رسالة الترحيب"),description:A("用于新用户的欢迎消息模板","Welcome message template for new users","قالب رسالة ترحيب للمستخدمين الجدد"),content:A("欢迎来到我们的平台！我们很高兴您的加入。如果您有任何问题，请随时联系我们。","Welcome to our platform! We are glad to have you join us. If you have any questions, please feel free to contact us.","مرحبا بك في منصتنا! نحن سعداء لانضمامك إلينا. إذا كان لديك أي أسئلة، لا تتردد في الاتصال بنا."),category:"welcome",isActive:!0,createdAt:new Date("2024-01-08").toISOString(),updatedAt:new Date("2024-01-15").toISOString()},{id:k(),name:A("技术支持模板","Technical Support Template","قالب الدعم التقني"),description:A("技术支持相关的回复模板","Reply template for technical support","قالب الرد للدعم التقني"),content:A("感谢您的反馈。我们的技术团队正在处理您的问题，预计在24小时内给您回复。","Thank you for your feedback. Our technical team is working on your issue and we expect to reply within 24 hours.","شكرا لك على ملاحظاتك. فريقنا التقني يعمل على مشكلتك ونتوقع الرد خلال 24 ساعة."),category:"support",isActive:!0,createdAt:new Date("2024-01-10").toISOString(),updatedAt:new Date("2024-01-12").toISOString()},{id:k(),name:A("产品介绍模板","Product Introduction Template","قالب تقديم المنتج"),description:A("用于介绍产品功能的模板","Template for introducing product features","قالب لتقديم ميزات المنتج"),content:A("我们的产品具有以下特点：1. 智能化操作 2. 高效性能 3. 用户友好界面 4. 安全可靠","Our product has the following features: 1. Intelligent operation 2. High efficiency 3. User-friendly interface 4. Safe and reliable","منتجنا له الميزات التالية: 1. تشغيل ذكي 2. كفاءة عالية 3. واجهة سهلة الاستخدام 4. آمن وموثوق"),category:"product",isActive:!1,createdAt:new Date("2024-01-05").toISOString(),updatedAt:new Date("2024-01-20").toISOString()}],cr=()=>({defaultAvatars:["https://images.unsplash.com/photo-1494790108755-2616b612b742?w=150&h=150&fit=crop&crop=face","https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face","https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face","https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face","https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face","https://images.unsplash.com/photo-1560250097-0b93528c311a?w=150&h=150&fit=crop&crop=face"]}),rt=x.createContext(void 0),F=()=>{const r=x.useContext(rt);if(r===void 0)throw new Error("useData must be used within a DataProvider");return r};function ue(r,s,o){try{const n=localStorage.getItem(r);if(!n)return s;const a=JSON.parse(n);return o&&!o(a)?(console.warn("Invalid data format for key: "+r+", using default value"),s):a}catch(n){return console.warn("Failed to parse localStorage data for key: "+r,n),s}}const dr=r=>Array.isArray(r)&&r.every(s=>s&&typeof s=="object"&&typeof s.id=="string"&&typeof s.botId=="string"),ur=r=>Array.isArray(r)&&r.every(s=>s&&typeof s=="object"&&typeof s.id=="string"&&typeof s.name=="object"),pr=r=>r&&typeof r=="object"&&Array.isArray(r.defaultAvatars),mr=({children:r})=>{Ce.useEffect(()=>{const u="1.0.0";localStorage.getItem("demo_data_version")!==u&&(localStorage.removeItem("demo_characters"),localStorage.removeItem("demo_templates"),localStorage.removeItem("demo_config"),localStorage.setItem("demo_data_version",u),console.log("Data cleaned up for version:",u))},[]);const[s,o]=x.useState(()=>ue("demo_characters",ir(),dr)),[n,a]=x.useState(()=>ue("demo_templates",lr(),ur)),[i,c]=x.useState(()=>ue("demo_config",cr(),pr)),d=x.useCallback((u,y)=>{try{localStorage.setItem(u,JSON.stringify(y))}catch(j){console.error("Failed to save data to localStorage for key: "+u,j)}},[]),T=x.useCallback(u=>{const y={...u,id:k(),botId:`bot_${k()}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};o(j=>{const b=[...j,y];return d("demo_characters",b),b})},[d]),m=x.useCallback((u,y)=>{o(j=>{const b=j.map(P=>P.id===u?{...P,...y,updatedAt:new Date().toISOString()}:P);return d("demo_characters",b),b})},[d]),l=x.useCallback(u=>{o(y=>{const j=y.filter(b=>b.id!==u);return d("demo_characters",j),j})},[d]),t=x.useCallback(u=>s.find(y=>y.id===u),[s]),p=x.useCallback(u=>{const y={...u,id:k(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};a(j=>{const b=[...j,y];return d("demo_templates",b),b})},[d]),f=x.useCallback((u,y)=>{a(j=>{const b=j.map(P=>P.id===u?{...P,...y,updatedAt:new Date().toISOString()}:P);return d("demo_templates",b),b})},[d]),S=x.useCallback(u=>{a(y=>{const j=y.filter(b=>b.id!==u);return d("demo_templates",j),j})},[d]),h=x.useCallback(u=>n.find(y=>y.id===u),[n]),v=x.useCallback(u=>{c(y=>{const j={...y,...u};return d("demo_config",j),j})},[d]),w=x.useCallback((u,y)=>{const j=s.find(b=>b.id===u);j&&m(u,{whitelist:[...j.whitelist||[],y]})},[m,s]),N=x.useCallback((u,y)=>{const j=s.find(b=>b.id===u);j&&m(u,{whitelist:(j.whitelist||[]).filter(b=>b!==y)})},[m,s]),B={characters:s,addCharacter:T,updateCharacter:m,deleteCharacter:l,getCharacter:t,templates:n,addTemplate:p,updateTemplate:f,deleteTemplate:S,getTemplate:h,config:i,updateConfig:v,addToWhitelist:w,removeFromWhitelist:N};return e.jsx(rt.Provider,{value:B,children:r})},hr=({open:r,onCancel:s,characterId:o,characterName:n})=>{const[a,i]=x.useState(""),[c,d]=x.useState(!1),{characters:T,addToWhitelist:m,removeFromWhitelist:l}=F(),t=T.find(v=>v.id===o),p=(t==null?void 0:t.whitelist)||[],f=async()=>{if(!a.trim()){I.error("请输入手机号");return}if(!g.PHONE.pattern.test(a)){I.error(g.PHONE.message);return}if(p.includes(a)){I.error("该手机号已存在");return}d(!0);try{await new Promise(v=>setTimeout(v,500)),m(o,a),i(""),I.success("添加成功")}catch{I.error("添加失败")}finally{d(!1)}},S=async v=>{d(!0);try{await new Promise(w=>setTimeout(w,300)),l(o,v),I.success("移除成功")}catch{I.error("移除失败")}finally{d(!1)}},h=v=>{v.key==="Enter"&&f()};return e.jsxs(ge,{title:e.jsxs("div",{children:[e.jsx(je,{style:{marginRight:8}}),"白名单管理 - ",n]}),open:r,onCancel:s,width:600,footer:null,children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(M.Group,{compact:!0,style:{display:"flex"},children:[e.jsx(M,{placeholder:"请输入手机号（如：13800138000）",value:a,onChange:v=>i(v.target.value),onKeyPress:h,style:{flex:1},maxLength:11}),e.jsx(E,{type:"primary",icon:e.jsx(G,{}),onClick:f,loading:c,children:"添加"})]})}),e.jsx("div",{style:{maxHeight:400,overflowY:"auto",border:"1px solid #f0f0f0",borderRadius:6,padding:8},children:p.length===0?e.jsx(fe,{description:"暂无白名单用户",image:fe.PRESENTED_IMAGE_SIMPLE,style:{padding:"40px 0"}}):e.jsx(ye,{dataSource:p,renderItem:(v,w)=>e.jsx(ye.Item,{actions:[e.jsx(ee,{title:"确认移除",description:`确定要将 ${v} 从白名单中移除吗？`,onConfirm:()=>S(v),okText:"确认",cancelText:"取消",children:e.jsx(E,{type:"text",danger:!0,icon:e.jsx(te,{}),size:"small"})})],style:{padding:"8px 12px",backgroundColor:w%2===0?"#fafafa":"#fff",borderRadius:4,margin:"4px 0"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(je,{style:{marginRight:8,color:"#1890ff"}}),e.jsx("span",{style:{fontFamily:"monospace",fontSize:14},children:v})]})},v)})}),e.jsxs("div",{style:{marginTop:16,padding:12,backgroundColor:"#f6f8fa",borderRadius:6,fontSize:12,color:"#666"},children:[e.jsx("div",{style:{marginBottom:4},children:e.jsx("strong",{children:"说明："})}),e.jsx("div",{children:"• 只有白名单中的手机号才能访问该私有AI角色"}),e.jsx("div",{children:"• 手机号格式：以1开头的11位数字"}),e.jsxs("div",{children:["• 当前白名单用户数量：",p.length]})]})]})},{Search:xr}=M,{Title:gr,Text:Ie}=z,fr=()=>{const r=H(),{characters:s,deleteCharacter:o}=F(),[n,a]=x.useState(""),[i,c]=x.useState({open:!1,characterId:"",characterName:""}),d=x.useMemo(()=>n.trim()?s.filter(t=>{const p=n.toLowerCase();return t.botId.toLowerCase().includes(p)||t.nickname.zh.toLowerCase().includes(p)||t.nickname.en.toLowerCase().includes(p)||t.nickname.ar.toLowerCase().includes(p)}):s,[s,n]),T=async t=>{try{o(t.id),I.success("删除成功")}catch{I.error("删除失败")}},m=t=>{c({open:!0,characterId:t.id,characterName:t.nickname.zh})},l=[{title:"Bot ID",dataIndex:"botId",key:"botId",width:150,render:t=>e.jsx(Ie,{code:!0,style:{fontSize:12},children:t})},{title:"头像",dataIndex:"avatar",key:"avatar",width:80,render:t=>e.jsx(Re,{src:t,size:48})},{title:"昵称",dataIndex:"nickname",key:"nickname",render:(t,p)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500,marginBottom:4},children:t.zh}),e.jsxs("div",{style:{fontSize:12,color:"#666"},children:[p.profession.zh," · ",p.region.zh]})]})},{title:"性别/年龄",key:"genderAge",width:100,render:t=>{var f;return`${(f=Je.find(S=>S.value===t.gender))==null?void 0:f.label} / ${t.age}岁`}},{title:"权限",dataIndex:"permission",key:"permission",width:100,render:t=>{const p=Ze.find(f=>f.value===t);return e.jsx(Z,{color:t==="public"?"green":"orange",children:p==null?void 0:p.label})}},{title:"白名单用户",key:"whitelistCount",width:120,render:t=>e.jsx("div",{style:{textAlign:"center"},children:t.permission==="private"?e.jsxs(Z,{color:"blue",children:[t.whitelist.length," 人"]}):e.jsx(Ie,{type:"secondary",children:"-"})})},{title:"最后更新",dataIndex:"updatedAt",key:"updatedAt",width:140,sorter:(t,p)=>D(t.updatedAt).unix()-D(p.updatedAt).unix(),render:t=>e.jsx("div",{style:{fontSize:12},children:D(t).format("YYYY-MM-DD HH:mm")})},{title:"操作",key:"actions",width:200,render:t=>e.jsxs(Y,{size:"small",children:[e.jsx(E,{type:"link",size:"small",icon:e.jsx(ke,{}),onClick:()=>r(`/characters/edit/${t.id}`),children:"查看"}),e.jsx(E,{type:"link",size:"small",icon:e.jsx(Me,{}),onClick:()=>r(`/characters/edit/${t.id}`),children:"编辑"}),t.permission==="private"&&e.jsx(E,{type:"link",size:"small",icon:e.jsx(jt,{}),onClick:()=>m(t),children:"白名单"}),e.jsx(ee,{title:"确认删除",description:e.jsxs("div",{children:[e.jsxs("div",{children:["确定要删除角色 ",e.jsx("strong",{children:t.nickname.zh})," 吗？"]}),e.jsx("div",{style:{color:"#ff4d4f",fontSize:12,marginTop:4},children:"此操作不可恢复"})]}),onConfirm:()=>T(t),okText:"确认删除",cancelText:"取消",okButtonProps:{danger:!0},children:e.jsx(E,{type:"link",size:"small",danger:!0,icon:e.jsx(te,{}),children:"删除"})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx(gr,{level:3,style:{margin:0},children:"AI角色管理"}),e.jsx(E,{type:"primary",icon:e.jsx(G,{}),onClick:()=>r("/characters/new"),size:"large",children:"新增AI角色"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{display:"flex",gap:16,alignItems:"center"},children:e.jsx(xr,{placeholder:"搜索角色昵称或Bot ID",style:{width:300},onSearch:a,onChange:t=>a(t.target.value),allowClear:!0})}),e.jsxs("div",{style:{color:"#666",fontSize:14},children:["共 ",d.length," 个角色"]})]})]}),e.jsx(C,{children:e.jsx(Le,{columns:l,dataSource:d,rowKey:"id",pagination:{...tt,total:d.length,showTotal:(t,p)=>`第 ${p[0]}-${p[1]} 条，共 ${t} 条`},scroll:{x:1200}})}),e.jsx(hr,{open:i.open,onCancel:()=>c({open:!1,characterId:"",characterName:""}),characterId:i.characterId,characterName:i.characterName})]})},st=({activeLanguage:r,onChange:s,className:o="language-tabs"})=>{const n=er.map(a=>({key:a.key,label:e.jsxs("span",{children:[a.flag," ",a.label]})}));return e.jsx(vt,{activeKey:r,onChange:a=>s(a),items:n,className:o,size:"large",type:"card"})},be=({value:r=[],onChange:s,maxCount:o=1,listType:n="picture-card",disabled:a=!1})=>{const[i,c]=x.useState(!1),[d,T]=x.useState(""),[m,l]=x.useState(""),t=u=>new Promise(y=>{setTimeout(()=>{const j=URL.createObjectURL(u);y(j)},1e3)}),p=u=>new Promise((y,j)=>{const b=new FileReader;b.readAsDataURL(u),b.onload=()=>y(b.result),b.onerror=P=>j(P)}),f=r.map((u,y)=>({uid:`${y}`,name:`image-${y}.jpg`,status:"done",url:u})),S=async u=>{!u.url&&!u.preview&&(u.preview=await p(u.originFileObj)),T(u.url||u.preview),c(!0),l(u.name||u.url.substring(u.url.lastIndexOf("/")+1))},h=u=>V.ACCEPTED_IMAGE_TYPES.includes(u.type)?u.size<=V.MAX_FILE_SIZE?!0:(I.error("图片大小不能超过 5MB！"),!1):(I.error("只能上传 JPG/PNG/GIF/WebP 格式的图片！"),!1),v=async u=>{const{file:y,onSuccess:j,onError:b}=u;try{const P=await t(y);j({url:P},y)}catch(P){console.error("Upload failed:",P),b(P)}},w=({fileList:u})=>{const y=u.filter(j=>j.status==="done").map(j=>{var b;return((b=j.response)==null?void 0:b.url)||j.url}).filter(Boolean);s==null||s(y)},N=u=>{const y=r.filter(j=>j!==u.url);s==null||s(y)},B=e.jsxs("div",{children:[e.jsx(G,{}),e.jsx("div",{style:{marginTop:8},children:"上传图片"})]});return e.jsxs(e.Fragment,{children:[e.jsx(Ne,{customRequest:v,listType:n,fileList:f,onPreview:S,onChange:w,onRemove:N,beforeUpload:h,disabled:a,multiple:o>1,children:f.length>=o?null:B}),e.jsx(ge,{open:i,title:m,footer:null,onCancel:()=>c(!1),children:e.jsx("img",{alt:"preview",style:{width:"100%"},src:d})})]})},{Title:yr}=z,{TextArea:pe}=M,_e=()=>{const[r]=_.useForm(),s=H(),{id:o}=Pe(),n=!!o,{addCharacter:a,updateCharacter:i,getCharacter:c}=F(),[d,T]=x.useState(!1),[m,l]=x.useState("zh"),[t,p]=x.useState(null);x.useEffect(()=>{if(n&&o){const h=c(o);h?(p(h),r.setFieldsValue({...h,nickname:h.nickname[m],region:h.region[m],profession:h.profession[m],introduction:h.introduction[m],tags:h.tags[m],greeting:h.greeting[m]})):(I.error("角色不存在"),s("/characters"))}else r.setFieldsValue({avatar:U.CHARACTER.AVATAR,gender:U.CHARACTER.GENDER,age:U.CHARACTER.AGE,permission:U.CHARACTER.PERMISSION,displayImages:[],tags:[]})},[n,o,c,r,s,m]),x.useEffect(()=>{t&&r.setFieldsValue({nickname:t.nickname[m],region:t.region[m],profession:t.profession[m],introduction:t.introduction[m],tags:t.tags[m],greeting:t.greeting[m]})},[m,t,r]);const f=(h,v)=>({...v||{zh:"",en:"",ar:""},[m]:h||""}),S=async h=>{T(!0);try{const v={nickname:f(h.nickname,t==null?void 0:t.nickname),region:f(h.region,t==null?void 0:t.region),profession:f(h.profession,t==null?void 0:t.profession),introduction:f(h.introduction,t==null?void 0:t.introduction),greeting:f(h.greeting,t==null?void 0:t.greeting),tags:{...(t==null?void 0:t.tags)||{zh:[],en:[],ar:[]},[m]:h.tags||[]}},w={avatar:h.avatar,gender:h.gender,age:h.age,permission:h.permission,displayImages:h.displayImages||[],systemPrompt:h.systemPrompt||"",whitelist:(t==null?void 0:t.whitelist)||[],...v};await new Promise(N=>setTimeout(N,1e3)),n&&t?(i(t.id,w),I.success("更新成功")):(a(w),I.success("创建成功")),s("/characters")}catch(v){I.error(n?"更新失败":"创建失败"),console.error("Submit error:",v)}finally{T(!1)}};return e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:24},children:e.jsxs(Y,{children:[e.jsx(E,{icon:e.jsx(Oe,{}),onClick:()=>s("/characters"),children:"返回列表"}),e.jsx(yr,{level:3,style:{margin:0},children:n?"编辑AI角色":"新增AI角色"}),n&&t&&e.jsxs(Z,{color:"blue",children:["Bot ID: ",t.botId]})]})}),e.jsx(C,{children:e.jsxs(_,{form:r,layout:"vertical",onFinish:S,scrollToFirstError:!0,children:[e.jsxs(X,{gutter:24,children:[e.jsxs($,{xs:24,lg:12,children:[e.jsxs(C,{title:"基本信息",size:"small",style:{marginBottom:24},children:[e.jsx(_.Item,{name:"avatar",label:"头像",rules:[g.REQUIRED],children:e.jsx(be,{maxCount:1})}),e.jsxs(X,{gutter:16,children:[e.jsx($,{span:12,children:e.jsx(_.Item,{name:"gender",label:"性别",rules:[g.REQUIRED],children:e.jsx(K,{options:Je})})}),e.jsx($,{span:12,children:e.jsx(_.Item,{name:"age",label:"年龄",rules:[g.REQUIRED,g.AGE],children:e.jsx(Tt,{min:1,max:150,style:{width:"100%"}})})})]}),e.jsx(_.Item,{name:"permission",label:"权限设置",rules:[g.REQUIRED],children:e.jsx(K,{options:Ze})})]}),e.jsx(C,{title:"媒体信息",size:"small",style:{marginBottom:24},children:e.jsx(_.Item,{name:"displayImages",label:"展示图片",help:"最多可上传6张展示图片",children:e.jsx(be,{maxCount:6})})}),e.jsx(C,{title:"高级设置",size:"small",children:e.jsx(_.Item,{name:"systemPrompt",label:"System Prompt",help:"系统提示词，用于指导AI的行为和回复风格",rules:[{max:g.MAX_LENGTH.SYSTEM_PROMPT,message:`最多${g.MAX_LENGTH.SYSTEM_PROMPT}个字符`}],children:e.jsx(pe,{rows:6,placeholder:"输入系统提示词，例如：You are a helpful and friendly AI assistant...",showCount:!0,maxLength:g.MAX_LENGTH.SYSTEM_PROMPT})})})]}),e.jsx($,{xs:24,lg:12,children:e.jsxs(C,{title:"多语言信息",size:"small",extra:e.jsx(st,{activeLanguage:m,onChange:l}),children:[e.jsx(_.Item,{name:"nickname",label:"昵称",rules:[g.REQUIRED,{max:g.MAX_LENGTH.NICKNAME,message:`最多${g.MAX_LENGTH.NICKNAME}个字符`}],children:e.jsx(M,{placeholder:"输入角色昵称",maxLength:g.MAX_LENGTH.NICKNAME})}),e.jsxs(X,{gutter:16,children:[e.jsx($,{span:12,children:e.jsx(_.Item,{name:"region",label:"地区",rules:[g.REQUIRED,{max:g.MAX_LENGTH.REGION,message:`最多${g.MAX_LENGTH.REGION}个字符`}],children:e.jsx(M,{placeholder:"如：北京",maxLength:g.MAX_LENGTH.REGION})})}),e.jsx($,{span:12,children:e.jsx(_.Item,{name:"profession",label:"职业",rules:[g.REQUIRED,{max:g.MAX_LENGTH.PROFESSION,message:`最多${g.MAX_LENGTH.PROFESSION}个字符`}],children:e.jsx(M,{placeholder:"如：AI助手",maxLength:g.MAX_LENGTH.PROFESSION})})})]}),e.jsx(_.Item,{name:"introduction",label:"介绍",rules:[g.REQUIRED,{max:g.MAX_LENGTH.INTRODUCTION,message:`最多${g.MAX_LENGTH.INTRODUCTION}个字符`}],children:e.jsx(pe,{rows:4,placeholder:"输入角色介绍",showCount:!0,maxLength:g.MAX_LENGTH.INTRODUCTION})}),e.jsx(_.Item,{name:"tags",label:"标签",help:"输入标签后按回车键添加",children:e.jsx(K,{mode:"tags",placeholder:"添加标签",maxTagCount:5,maxTagTextLength:g.MAX_LENGTH.TAG})}),e.jsx(_.Item,{name:"greeting",label:"开场白",rules:[g.REQUIRED,{max:g.MAX_LENGTH.GREETING,message:`最多${g.MAX_LENGTH.GREETING}个字符`}],children:e.jsx(pe,{rows:3,placeholder:"输入角色的开场白",showCount:!0,maxLength:g.MAX_LENGTH.GREETING})})]})})]}),e.jsx(De,{}),e.jsx("div",{style:{textAlign:"center"},children:e.jsxs(Y,{children:[e.jsx(E,{size:"large",onClick:()=>s("/characters"),children:"取消"}),e.jsx(E,{type:"primary",htmlType:"submit",loading:d,size:"large",icon:e.jsx($e,{}),children:d?"保存中...":n?"更新角色":"创建角色"})]})})]})})]})},{Search:jr}=M,{Title:vr}=z,Tr=()=>{const r=H(),{templates:s,deleteTemplate:o,updateTemplate:n}=F(),[a,i]=x.useState(""),c=x.useMemo(()=>a.trim()?s.filter(l=>{const t=a.toLowerCase();return l.name.zh.toLowerCase().includes(t)||l.name.en.toLowerCase().includes(t)||l.name.ar.toLowerCase().includes(t)||l.description.zh.toLowerCase().includes(t)||l.description.en.toLowerCase().includes(t)||l.description.ar.toLowerCase().includes(t)||l.category.toLowerCase().includes(t)}):s,[s,a]),d=async l=>{try{o(l.id),I.success("删除成功")}catch{I.error("删除失败")}},T=async(l,t)=>{try{n(l.id,{isActive:t}),I.success(t?"已启用":"已禁用")}catch{I.error("操作失败")}},m=[{title:"模板名称",dataIndex:"name",key:"name",render:(l,t)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500,marginBottom:4},children:l.zh}),e.jsx("div",{style:{fontSize:12,color:"#666"},children:t.description.zh})]})},{title:"分类",dataIndex:"category",key:"category",width:120,render:l=>{const t=et.find(p=>p.value===l);return e.jsx(Z,{color:"blue",children:(t==null?void 0:t.label)||l})}},{title:"状态",dataIndex:"isActive",key:"isActive",width:100,render:(l,t)=>e.jsx(ze,{checked:l,onChange:p=>T(t,p),checkedChildren:"启用",unCheckedChildren:"禁用"})},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:140,sorter:(l,t)=>D(l.createdAt).unix()-D(t.createdAt).unix(),render:l=>e.jsx("div",{style:{fontSize:12},children:D(l).format("YYYY-MM-DD HH:mm")})},{title:"最后更新",dataIndex:"updatedAt",key:"updatedAt",width:140,sorter:(l,t)=>D(l.updatedAt).unix()-D(t.updatedAt).unix(),render:l=>e.jsx("div",{style:{fontSize:12},children:D(l).format("YYYY-MM-DD HH:mm")})},{title:"操作",key:"actions",width:150,render:l=>e.jsxs(Y,{size:"small",children:[e.jsx(E,{type:"link",size:"small",icon:e.jsx(Me,{}),onClick:()=>r(`/templates/edit/${l.id}`),children:"编辑"}),e.jsx(ee,{title:"确认删除",description:e.jsxs("div",{children:[e.jsxs("div",{children:["确定要删除模板 ",e.jsx("strong",{children:l.name.zh})," 吗？"]}),e.jsx("div",{style:{color:"#ff4d4f",fontSize:12,marginTop:4},children:"此操作不可恢复"})]}),onConfirm:()=>d(l),okText:"确认删除",cancelText:"取消",okButtonProps:{danger:!0},children:e.jsx(E,{type:"link",size:"small",danger:!0,icon:e.jsx(te,{}),children:"删除"})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx(vr,{level:3,style:{margin:0},children:"模板管理"}),e.jsx(E,{type:"primary",icon:e.jsx(G,{}),onClick:()=>r("/templates/new"),size:"large",children:"新增模板"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{display:"flex",gap:16,alignItems:"center"},children:e.jsx(jr,{placeholder:"搜索模板名称、描述或分类",style:{width:300},onSearch:i,onChange:l=>i(l.target.value),allowClear:!0})}),e.jsxs("div",{style:{color:"#666",fontSize:14},children:["共 ",c.length," 个模板 （启用 ",c.filter(l=>l.isActive).length," 个）"]})]})]}),e.jsx(C,{children:e.jsx(Le,{columns:m,dataSource:c,rowKey:"id",pagination:{...tt,total:c.length,showTotal:(l,t)=>`第 ${t[0]}-${t[1]} 条，共 ${l} 条`}})})]})},{Title:Ir}=z,{TextArea:Ee}=M,Ae=()=>{const[r]=_.useForm(),s=H(),{id:o}=Pe(),n=!!o,{addTemplate:a,updateTemplate:i,getTemplate:c}=F(),[d,T]=x.useState(!1),[m,l]=x.useState("zh"),[t,p]=x.useState(null);x.useEffect(()=>{if(n&&o){const h=c(o);h?(p(h),r.setFieldsValue({...h,name:h.name[m],description:h.description[m],content:h.content[m]})):(I.error("模板不存在"),s("/templates"))}else r.setFieldsValue({category:U.TEMPLATE.CATEGORY,isActive:U.TEMPLATE.IS_ACTIVE})},[n,o,c,r,s,m]),x.useEffect(()=>{t&&r.setFieldsValue({name:t.name[m],description:t.description[m],content:t.content[m]})},[m,t,r]);const f=(h,v)=>({...v||{zh:"",en:"",ar:""},[m]:h||""}),S=async h=>{T(!0);try{const v={name:f(h.name,t==null?void 0:t.name),description:f(h.description,t==null?void 0:t.description),content:f(h.content,t==null?void 0:t.content)},w={category:h.category,isActive:h.isActive,...v};await new Promise(N=>setTimeout(N,1e3)),n&&t?(i(t.id,w),I.success("更新成功")):(a(w),I.success("创建成功")),s("/templates")}catch(v){I.error(n?"更新失败":"创建失败"),console.error("Submit error:",v)}finally{T(!1)}};return e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:24},children:e.jsxs(Y,{children:[e.jsx(E,{icon:e.jsx(Oe,{}),onClick:()=>s("/templates"),children:"返回列表"}),e.jsx(Ir,{level:3,style:{margin:0},children:n?"编辑模板":"新增模板"})]})}),e.jsx(C,{children:e.jsxs(_,{form:r,layout:"vertical",onFinish:S,scrollToFirstError:!0,children:[e.jsxs(X,{gutter:24,children:[e.jsx($,{xs:24,lg:8,children:e.jsxs(C,{title:"基本信息",size:"small",children:[e.jsx(_.Item,{name:"category",label:"分类",rules:[g.REQUIRED],children:e.jsx(K,{options:et})}),e.jsx(_.Item,{name:"isActive",label:"状态",valuePropName:"checked",children:e.jsx(ze,{checkedChildren:"启用",unCheckedChildren:"禁用"})})]})}),e.jsx($,{xs:24,lg:16,children:e.jsxs(C,{title:"多语言信息",size:"small",extra:e.jsx(st,{activeLanguage:m,onChange:l}),children:[e.jsx(_.Item,{name:"name",label:"模板名称",rules:[g.REQUIRED,{max:g.MAX_LENGTH.TEMPLATE_NAME,message:`最多${g.MAX_LENGTH.TEMPLATE_NAME}个字符`}],children:e.jsx(M,{placeholder:"输入模板名称",maxLength:g.MAX_LENGTH.TEMPLATE_NAME})}),e.jsx(_.Item,{name:"description",label:"模板描述",rules:[g.REQUIRED,{max:g.MAX_LENGTH.TEMPLATE_DESCRIPTION,message:`最多${g.MAX_LENGTH.TEMPLATE_DESCRIPTION}个字符`}],children:e.jsx(Ee,{rows:3,placeholder:"输入模板描述",showCount:!0,maxLength:g.MAX_LENGTH.TEMPLATE_DESCRIPTION})}),e.jsx(_.Item,{name:"content",label:"模板内容",rules:[g.REQUIRED,{max:g.MAX_LENGTH.TEMPLATE_CONTENT,message:`最多${g.MAX_LENGTH.TEMPLATE_CONTENT}个字符`}],children:e.jsx(Ee,{rows:12,placeholder:"输入模板内容...",showCount:!0,maxLength:g.MAX_LENGTH.TEMPLATE_CONTENT})})]})})]}),e.jsx(De,{}),e.jsx("div",{style:{textAlign:"center"},children:e.jsxs(Y,{children:[e.jsx(E,{size:"large",onClick:()=>s("/templates"),children:"取消"}),e.jsx(E,{type:"primary",htmlType:"submit",loading:d,size:"large",icon:e.jsx($e,{}),children:d?"保存中...":n?"更新模板":"创建模板"})]})})]})})]})},{Title:br,Text:me}=z,_r=()=>{const{config:r,updateConfig:s}=F(),[o,n]=x.useState(!1),[a,i]=x.useState(""),[c,d]=x.useState(""),T=p=>new Promise(f=>{setTimeout(()=>{const S=URL.createObjectURL(p);f(S)},1e3)}),m=async p=>{const{file:f,onSuccess:S,onError:h}=p;try{if(!V.ACCEPTED_IMAGE_TYPES.includes(f.type)){I.error("只能上传 JPG/PNG/GIF/WebP 格式的图片！"),h(new Error("Invalid file type"));return}if(!(f.size<=V.MAX_FILE_SIZE)){I.error("图片大小不能超过 5MB！"),h(new Error("File too large"));return}const N=await T(f),B=[...r.defaultAvatars,N];s({defaultAvatars:B}),I.success("头像上传成功"),S({url:N},f)}catch(v){console.error("Upload failed:",v),I.error("上传失败"),h(v)}},l=p=>{const f=r.defaultAvatars.filter(S=>S!==p);s({defaultAvatars:f}),I.success("删除成功")},t=p=>{i(p),d("默认头像预览"),n(!0)};return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(br,{level:3,style:{margin:0},children:"通用配置"}),e.jsx(me,{type:"secondary",children:"管理系统的通用配置信息"})]}),e.jsxs(C,{title:"默认头像管理",style:{marginBottom:24},children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(Ne,{customRequest:m,showUploadList:!1,accept:V.ACCEPTED_IMAGE_TYPES.join(","),children:e.jsx(E,{type:"primary",icon:e.jsx(G,{}),children:"上传新头像"})}),e.jsx(me,{type:"secondary",style:{marginLeft:12},children:"支持 JPG、PNG、GIF、WebP 格式，大小不超过 5MB"})]}),e.jsx("div",{style:{border:"1px solid #f0f0f0",borderRadius:8,padding:16,minHeight:200,backgroundColor:"#fafafa"},children:r.defaultAvatars.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0",color:"#999"},children:[e.jsx(G,{style:{fontSize:48,marginBottom:16}}),e.jsx("div",{children:"暂无默认头像"}),e.jsx("div",{style:{fontSize:12,marginTop:8},children:"点击上方按钮上传头像"})]}):e.jsx(X,{gutter:[16,16],children:r.defaultAvatars.map((p,f)=>e.jsx($,{xs:12,sm:8,md:6,lg:4,children:e.jsx(C,{hoverable:!0,size:"small",cover:e.jsx("div",{style:{height:120,background:`url(${p}) center/cover`,borderRadius:"8px 8px 0 0"}}),actions:[e.jsx(E,{type:"text",icon:e.jsx(ke,{}),onClick:()=>t(p)},"preview"),e.jsx(ee,{title:"确认删除",description:"确定要删除这个默认头像吗？",onConfirm:()=>l(p),okText:"确认",cancelText:"取消",children:e.jsx(E,{type:"text",danger:!0,icon:e.jsx(te,{})})},"delete")],children:e.jsx(C.Meta,{title:`头像 ${f+1}`,description:e.jsx(me,{type:"secondary",style:{fontSize:12},children:"默认头像"})})})},f))})}),e.jsxs("div",{style:{marginTop:16,padding:12,backgroundColor:"#f6f8fa",borderRadius:6,fontSize:12,color:"#666"},children:[e.jsx("div",{style:{marginBottom:4},children:e.jsx("strong",{children:"说明："})}),e.jsx("div",{children:"• 默认头像将在创建AI角色时作为头像选项提供"}),e.jsx("div",{children:"• 建议上传尺寸为 150x150 像素的正方形图片"}),e.jsxs("div",{children:["• 当前默认头像数量：",r.defaultAvatars.length]})]})]}),e.jsx(ge,{open:o,title:c,footer:null,onCancel:()=>n(!1),children:e.jsx("img",{alt:"preview",style:{width:"100%"},src:a})})]})},{Title:Er,Text:Se}=z,Ar=()=>e.jsxs("div",{children:[e.jsx(Er,{level:2,children:"测试页面"}),e.jsxs(C,{children:[e.jsx(Se,{children:"这是一个简单的测试页面，用来验证路由是否正常工作。"}),e.jsx("br",{}),e.jsx(Se,{type:"secondary",children:"如果您能看到这个页面，说明路由配置是正确的。"})]})]}),{Title:we,Text:Sr}=z,wr=()=>{const r=H();return e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:24},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx(we,{level:3,style:{margin:0},children:"AI角色管理（简化版）"}),e.jsx(E,{type:"primary",icon:e.jsx(G,{}),onClick:()=>r("/characters/new"),size:"large",children:"新增AI角色"})]})}),e.jsx(C,{children:e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(J,{style:{fontSize:48,marginBottom:16,color:"#1890ff"}}),e.jsxs("div",{children:[e.jsx(we,{level:4,children:"简化的角色列表页面"}),e.jsx(Sr,{type:"secondary",children:"这是一个不依赖数据上下文的简化版本，用于测试路由是否正常工作。"})]}),e.jsx("div",{style:{marginTop:24},children:e.jsxs(Y,{children:[e.jsx(E,{onClick:()=>r("/test"),children:"测试页面"}),e.jsx(E,{onClick:()=>r("/config"),children:"通用配置"}),e.jsx(E,{type:"primary",ghost:!0,onClick:()=>r("/characters"),children:"完整角色列表"})]})})]})})]})};I.config({top:100,duration:3,maxCount:3});const O=({children:r})=>{const{isAuthenticated:s}=de();return s?e.jsx(ar,{children:r}):e.jsx(Q,{to:"/login",replace:!0})},Cr=({children:r})=>{const{isAuthenticated:s}=de();return s?e.jsx(Q,{to:"/simple",replace:!0}):e.jsx(e.Fragment,{children:r})};function Pr(){return e.jsx(Kt,{children:e.jsx(mr,{children:e.jsxs(lt,{children:[e.jsx(L,{path:"/login",element:e.jsx(Cr,{children:e.jsx(Zt,{})})}),e.jsx(L,{path:"/",element:e.jsx(Q,{to:"/simple",replace:!0})}),e.jsx(L,{path:"/test",element:e.jsx(O,{children:e.jsx(Ar,{})})}),e.jsx(L,{path:"/simple",element:e.jsx(O,{children:e.jsx(wr,{})})}),e.jsx(L,{path:"/characters",element:e.jsx(O,{children:e.jsx(fr,{})})}),e.jsx(L,{path:"/characters/new",element:e.jsx(O,{children:e.jsx(_e,{})})}),e.jsx(L,{path:"/characters/edit/:id",element:e.jsx(O,{children:e.jsx(_e,{})})}),e.jsx(L,{path:"/templates",element:e.jsx(O,{children:e.jsx(Tr,{})})}),e.jsx(L,{path:"/templates/new",element:e.jsx(O,{children:e.jsx(Ae,{})})}),e.jsx(L,{path:"/templates/edit/:id",element:e.jsx(O,{children:e.jsx(Ae,{})})}),e.jsx(L,{path:"/config",element:e.jsx(O,{children:e.jsx(_r,{})})}),e.jsx(L,{path:"*",element:e.jsx(Q,{to:"/simple",replace:!0})})]})})})}xe.createRoot(document.getElementById("root")).render(e.jsx(Ce.StrictMode,{children:e.jsx(ct,{children:e.jsx(It,{locale:qt,children:e.jsx(Pr,{})})})}));
